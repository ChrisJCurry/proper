(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4a964133"],{"23a1":function(t,e,a){"use strict";a("3129")},3129:function(t,e,a){},"473f":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var s=a("83fc"),c=a("8a4e"),n=a("2b20");class o{async getAccount(){try{const t=await n["a"].get("/account");s["a"].account=t.data}catch(t){c["a"].error("HAVE YOU STARTED YOUR SERVER YET???",t)}}async getAll(){try{const t=await n["a"].get("/account/all");s["a"].accounts=t.data}catch(t){c["a"].error("Error retrieving accounts")}}async getByEmail(t){try{const e=await n["a"].get("/account/"+t);return e.data}catch(e){c["a"].error("Error retrieving accounts")}}}const i=new o},"63d7":function(t,e,a){"use strict";a.r(e);var s=a("7a23");const c=Object(s["O"])("data-v-69787739");Object(s["w"])("data-v-69787739");const n={class:"container-fluid messages-page"},o=Object(s["h"])("div",{class:"row mt-3 text-white"}," Messages Property Management ",-1),i={class:"row mt-5"},r={class:"col-12 text-right"},d={key:0},b={class:"mt-4"},l={class:"row"},g={key:0,class:"col-12 text-center text-light"},u=Object(s["h"])("div",null," Conversation With: ",-1),O={class:"messaging-container container-fluid border border-dark rounded shadow mt-3 bg-light"},j={key:0,class:"row"},m={class:"col-12 text-right mt-2"},h={class:"text-sizing"},w={class:"row mb-2"},y={class:"col-12 text-sizing"},v={key:1,class:"row bg-secondary"},p={class:"col-8 mt-3"},M={class:"text-sizing"},f={class:"row"},k={class:"col-12 text-sizing mt-1 mb-1"},E={class:"row mt-5"},x={class:"col"},_=Object(s["h"])("div",{class:"input-group-append"},[Object(s["h"])("button",{class:"btn btn-primary text-dark",type:"submit"}," Send ")],-1),I={class:"mt-5"},z={key:0,class:"mt-5"},U={key:0,class:"m-2"},A={key:1};Object(s["u"])();const B=c((t,e,a,c,B,T)=>(Object(s["t"])(),Object(s["d"])(s["a"],null,[Object(s["h"])("div",n,[o,Object(s["h"])("div",i,[Object(s["h"])("div",r,[Object(s["h"])("button",{type:"button",class:"btn btn-dark text-sizing ",onClick:e[1]||(e[1]=t=>(c.state.showNewMessage=!c.state.showNewMessage,c.state.showCurrentMessage=!1))}," New ")])]),c.state.showCurrentMessage?(Object(s["t"])(),Object(s["d"])("div",d,[Object(s["h"])("div",b,[Object(s["h"])("div",l,[c.state.to?(Object(s["t"])(),Object(s["d"])("div",g,[u,Object(s["h"])("img",{class:"image-size mt-3",src:c.state.to.picture,alt:"avatar"},null,8,["src"]),Object(s["g"])(" "+Object(s["E"])(c.state.to.name),1)])):Object(s["e"])("",!0)]),Object(s["h"])("div",O,[(Object(s["t"])(!0),Object(s["d"])(s["a"],null,Object(s["z"])(c.state.messages[c.state.to._id],t=>(Object(s["t"])(),Object(s["d"])("div",{key:t._id},[t.creatorId===c.state.account.id?(Object(s["t"])(),Object(s["d"])("div",j,[Object(s["h"])("div",m,[Object(s["h"])("span",h,[Object(s["g"])(Object(s["E"])(t.body)+" ",1),Object(s["h"])("img",{class:"image-size",src:c.state.account.picture,alt:"avatar"},null,8,["src"])]),Object(s["h"])("div",w,[Object(s["h"])("div",y,Object(s["E"])(new Date(t.createdAt).toLocaleTimeString()),1)])])])):(Object(s["t"])(),Object(s["d"])("div",v,[Object(s["h"])("div",p,[Object(s["h"])("span",M,[Object(s["h"])("img",{class:"image-size",src:c.state.account.picture,alt:"avatar"},null,8,["src"]),Object(s["g"])(" "+Object(s["E"])(t.body)+" ",1),Object(s["h"])("div",f,[Object(s["h"])("div",k,Object(s["E"])(new Date(t.createdAt).toLocaleTimeString()),1)])])])]))]))),128))])]),Object(s["h"])("div",E,[Object(s["h"])("div",x,[Object(s["h"])("form",{class:"input-group",onSubmit:e[3]||(e[3]=Object(s["N"])((...t)=>c.sendMessage&&c.sendMessage(...t),["prevent"]))},[Object(s["L"])(Object(s["h"])("textarea",{id:"message",class:"form-control","aria-label":"With textarea","onUpdate:modelValue":e[2]||(e[2]=t=>c.state.message.body=t)},null,512),[[s["G"],c.state.message.body]]),_],32)])])])):Object(s["e"])("",!0)]),Object(s["h"])("div",I,[c.state.showNewMessage?(Object(s["t"])(),Object(s["d"])("div",z,[(Object(s["t"])(!0),Object(s["d"])(s["a"],null,Object(s["z"])(c.state.accounts,t=>(Object(s["t"])(),Object(s["d"])("div",{key:t._id},[t._id!=c.state.account._id?(Object(s["t"])(),Object(s["d"])("div",U,[Object(s["h"])("button",{type:"button",class:"btn btn-primary text-dark btn-block",onClick:e=>c.openMessage(t.email)},Object(s["E"])(t.email),9,["onClick"])])):(Object(s["t"])(),Object(s["d"])("div",A))]))),128))])):Object(s["e"])("",!0)])],64)));var T=a("beb7"),C=a("83fc"),N=a("473f"),S=a("1157"),L=a.n(S),R={name:"MessagesPage",setup(){const t=Object(s["x"])({showCurrentMessage:!1,showNewMessage:!1,account:Object(s["b"])(()=>C["a"].account),accounts:Object(s["b"])(()=>C["a"].accounts),messages:Object(s["b"])(()=>C["a"].messages),to:{},message:{body:""}});return Object(s["r"])(async()=>{await N["a"].getAll(),await T["a"].getByUserId(t.account._id)}),{state:t,async openMessage(e){t.to={},t.showNewMessage=!1,t.showCurrentMessage=!0,t.to=await N["a"].getByEmail(e),setTimeout(()=>{document.getElementById("message").focus()},1),await T["a"].getByUserIdAndToId(t.account._id,t.to._id),C["a"].messages[t.account._id].length!==C["a"].readMessages[t.account._id]&&(C["a"].readMessages[t.account._id]=C["a"].messages[t.account._id],C["a"].newMessageUsers.splice(C["a"].newMessageUsers.indexOf(t.to),1),C["a"].newMessageUsers.length<1&&(document.getElementById("notification").classList.add("d-none"),document.getElementById("notification").classList.remove("d-sm-block")))},async sendMessage(){await T["a"].create(t.message,t.to._id),t.message={},console.log(L()(".messaging-container")),L()(".messaging-container").scrollTop(L()(".messaging-container")[0].scrollHeight)}}}};a("23a1");R.render=B,R.__scopeId="data-v-69787739";e["default"]=R},beb7:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var s=a("2b20"),c=a("83fc"),n=a("8a4e");class o{async getByUserId(t){try{const e=await s["a"].get("api/messages/"+t);return c["a"].messages[t]=e.data,e.data}catch(e){n["a"].log(e)}}async getByUserIdAndToId(t,e){const a=await s["a"].get("account/messages/"+e);c["a"].messages[e]=a.data}async create(t,e){try{delete t.id,t.toId=e;const a=await s["a"].post("api/messages",t);return a.data}catch(a){n["a"].error(a)}}}const i=new o}}]);